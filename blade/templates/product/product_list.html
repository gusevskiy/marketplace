{% extends 'includes/base_with_sidebar.html' %}

{% load thumbnail %}
{% block title %}
{% if category %}{{ category.name }}{% else %}Products{% endif %}
{% endblock %}

{% block main_content %}

<div class="row">
  <!-- Карточки товара -->
  {% for product in page_obj %}
  <div class="col-lg-4">
    <div class="product-card">

      <!-- Изображение продукта -->

      <div class="product-thumb">
        {% if product.images.first %}
        <!-- product.images.first.image -> "image" это поле в модели ProductImage -->
        {% thumbnail product.images.first.image "400x400" crop="center" as im %}
        <a href="{{ product.get_absolute_url }}">
          <img src="{{ im.url }}" alt="{{ product.name }}" />
        </a>
        {% endthumbnail %}
        {% else %}
        <div
          style="display: flex; align-items: center; justify-content: center; width: 100%; height: 200px; background-color: #ccc; border-radius: 5px;">
          Нет фото
        </div>
        {% endif %}
      </div>

      <!-- Информация о продукте -->
      <div class="product-details">
        <div class="product-name">
          <h5>{{ product.name }}</a>
          </h5>
        </div>
        <div class="product-bottom-details d-flex justify-content-between">
          <div class="product-price">
            <a>{{ product.price }} руб.</a>
          </div>
          <div class="product-links">
            <a href="">
              <!-- иконка -->
              <i class="fa-solid fa-cart-plus"></i>
            </a>
          </div>
        </div>
      </div>

    </div>
  </div>
  {% endfor %}
</div>
<div class="d-flex justify-content-center">
  {% include 'includes/paginator.html' %}
</div>
</div>

{% endblock %}